name: Create Public Gist
on: [push]

jobs:
  create-gist:
    runs-on: ubuntu-latest
    steps:
      - name: Create Public Gist with Data
        run: |
          # Generate your data
          DATA="Generated at: $(date)
Build number: ${{ github.run_number }}
Commit SHA: ${{ github.sha }}
Repository: ${{ github.repository }}
Branch: ${{ github.ref_name }}

Your string data content goes here
Additional data line 1
Additional data line 2"
          
          # Create public gist
          echo "ðŸ”„ Creating public gist..."
          GIST_RESPONSE=$(curl -s -X POST \
            -H "Authorization: token ${{ secrets.GITHUB_TOKEN }}" \
            -H "Accept: application/vnd.github.v3+json" \
            https://api.github.com/gists \
            -d '{
              "description": "Auto-generated data from GitHub Action - '"$(date)"'",
              "public": true,
              "files": {
                "api-data.txt": {
                  "content": "'"$DATA"'"
                }
              }
            }')
          
          # Extract URLs
          RAW_URL=$(echo "$GIST_RESPONSE" | jq -r '.files."api-data.txt".raw_url')
          GIST_URL=$(echo "$GIST_RESPONSE" | jq -r '.html_url')
          GIST_ID=$(echo "$GIST_RESPONSE" | jq -r '.id')
          
          echo ""
          echo "âœ… Gist created successfully!"
          echo "==========================================="
          echo "ðŸ“„ Gist URL: $GIST_URL"
          echo "ðŸ”— Raw URL (for API access): $RAW_URL"
          echo "ðŸ†” Gist ID: $GIST_ID"
          echo "==========================================="
          echo ""
          echo "ðŸ“‹ Testing raw access:"
          echo "----------------------------------------"
          sleep 2  # Wait for gist to be available
          curl -s "$RAW_URL"
          echo ""
          echo "----------------------------------------"
          
          echo ""
          echo "ðŸ’¡ Usage from external server:"
          echo "curl -s \"$RAW_URL\""
